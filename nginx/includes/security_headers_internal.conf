# =============================================================================
# Security Headers for Internal Deployment (Behind Main Proxy)
# =============================================================================
# Only includes headers that won't conflict with or duplicate
# headers set by the main reverse proxy.
#
# Headers like HSTS, X-Frame-Options, and Permissions-Policy are typically
# set by the main proxy — we omit them here to avoid duplication.
#
# IMPORTANT: If a location block uses add_header, it clears ALL parent headers.
# Any location with add_header MUST re-include security headers.
# Location blocks use security_headers_enhanced.conf for re-includes — the
# extra headers (like HSTS) are harmless when behind a proxy.
# =============================================================================

# Content Security Policy — strict for JSON API
# Main proxy may override this for HTML-serving applications
add_header Content-Security-Policy "default-src 'none'; frame-ancestors 'none'; base-uri 'none'; form-action 'none';" always;

# X-Content-Type-Options — Prevent MIME sniffing attacks
add_header X-Content-Type-Options "nosniff" always;

# X-Download-Options — Prevent file execution in Internet Explorer
add_header X-Download-Options "noopen" always;

# X-Permitted-Cross-Domain-Policies — Restrict Adobe Flash/PDF cross-domain access
add_header X-Permitted-Cross-Domain-Policies "none" always;

# Referrer Policy — Control referrer information leakage
add_header Referrer-Policy "strict-origin-when-cross-origin" always;
