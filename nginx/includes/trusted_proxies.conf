# =============================================================================
# Trusted Proxies Configuration (Internal Mode Only)
# =============================================================================
# Tells Nginx to trust X-Forwarded-For headers from the main reverse proxy.
# This allows rate limiting and logging to use the real client IP
# instead of the main proxy's IP address.
#
# Adjust the set_real_ip_from ranges to match your main proxy's network.
# =============================================================================

# Private network ranges — adjust to your infrastructure
set_real_ip_from 10.0.0.0/8;       # Class A private networks
set_real_ip_from 172.16.0.0/12;    # Class B private networks (includes Docker)
set_real_ip_from 192.168.0.0/16;   # Class C private networks

# Use the X-Forwarded-For header to extract the real client IP
real_ip_header X-Forwarded-For;

# Recursively search through X-Forwarded-For to find the real client IP
# This handles chains of proxies (client → proxy1 → proxy2 → this nginx)
real_ip_recursive on;
