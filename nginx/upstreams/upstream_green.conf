# Green environment upstream configuration
upstream app_green {
    # Shared memory zone for dynamic DNS resolution
    zone app_green_zone 64k;
    
    # Least connections load balancing
    least_conn;
    
    # Backend server with DNS resolution
    server app_green:3000 max_fails=3 fail_timeout=30s resolve;
    
    # Keepalive connections to backend
    keepalive 32;
    keepalive_requests 100;
    keepalive_timeout 60s;
}
