# Health check endpoint (high rate limit)
location /health {
    limit_req zone=health_limit burst=20 nodelay;
    
    # Proxy to active backend
    proxy_pass http://active_app;
    
    # Include common proxy settings
    include /etc/nginx/includes/proxy_headers.conf;
    include /etc/nginx/includes/proxy_timeouts_health.conf;
    
    # Disable buffering for health checks
    proxy_buffering off;
    
    # Cache control
    add_header Cache-Control "no-cache, no-store, must-revalidate";
    add_header Pragma "no-cache";
    add_header Expires "0";
}
